<html><head><link href="/simplecss/styles.css" rel="stylesheet"/>
<script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3040480045347797"></script>
<script async="" btn-style='{"backgroundColor":"#000","color":"#fff","border":"1px solid #000"}' button-text="Let's Connect" custom-font-size="16px" custom-font-weight="500" custom-padding="0px" custom-width="200px" defer="" embed-version="v1" position-bottom="30px" position-right="30px" src="https://topmate-embed.s3.ap-south-1.amazonaws.com/v1/topmate-embed.js" user-profile="https://topmate.io/embed/profile/ananth_tirumanur?theme=D5534D"></script>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WNB7CZV5');</script>
<!-- End Google Tag Manager -->
</head><body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WNB7CZV5"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<header><nav><ul><li><a href="https://www.iexpertify.com/">iExpertify</a></li><li><a href="https://www.iexpertify.com/free-utilities/">Free Utilities</a></li></ul></nav></header>
<h1>Remove Duplicates Stage in DataStage - A Comprehensive Guide</h1>
<p>The Remove Duplicates stage is a crucial processing stage in Data Warehousing, particularly when dealing with large datasets. This stage can have a single input link and a single output link, processing a single sorted dataset as input, eliminating duplicate rows, and writing the results to an output dataset.</p>
<p>For optimal performance, it's recommended that the input data is already sorted for this stage, ensuring that all records with similar key values are adjacent. In case sorting is not done prior, a 'Link Level Sort' can be performed instead of adding a separate ‘Sort stage’.</p>
<h2>Properties tab</h2>
<p>Key - Specifies the key column for the operation. This property can be repeated to specify multiple key columns.</p>
<h2>Options category</h2>
<p>Duplicate to retain - Specifies which of the duplicate columns encountered to retain. Choose between 'First' and 'Last'. It is set to 'First' by default.</p>
<h3>Example Input Data:</h3>
<pre>ID Name
          10 Joe
          11 Marsh
          12 Shawn
          10 Joe
          10 Roger</pre>
<h4>Step 1: Job Structure Design</h4>
<p>Design the job structure as shown below.</p>
<h4>Step 2: Sort Data</h4>
<p>Sort the data on ID column in a sort stage.</p>
<h4>Step 3: Configure Remove Duplicates Stage</h4>
<ul>
<li>Double click on the Remove duplicate stage.</li>
<li>Define 'key' as ID and 'Duplicate to retain' as 'First'.</li>
</ul>
<h4>Step 4: Map Output Columns</h4>
<p>Map all the required output columns under ‘Output’ tab in Remove duplicate stage.</p>
<pre>ID Name
          10 Joe
          11 Marsh
          12 Shawn
          Duplicate entries will get removed.</pre>
<h3>Alternative Methods to Remove Duplicates without using Remove Duplicates Stage in DataStage:</h3>
<ul>
<li><strong>Using Hash File Stage</strong> (Specify the keys and check the unique checkbox, Unique Key is not allowed duplicate values)</li>
<li>Using a sort stage, set property: ALLOW DUPLICATES : false</li>
<li>You can do it at any stage. Just do a hash partition of the input data and check the options stable Sort and Unique.</li>
</ul>
<footer>
<h3>Meet Ananth Tirumanur. Hi there 👋</h3>
<h4>I work on projects in data science, big data, data engineering, data modeling, software engineering, and system design.</h4>
<ul>
<li>👨‍💻 All of my projects are available at <a href="https://github.com/akrish1982">https://github.com/akrish1982</a></li>
<li>💬 Ask me about <strong>Data engineering, SQL, Databases, Data pipelines, Data infrastructure</strong></li>
<li>📄 My work history: <a href="https://www.linkedin.com/in/ananthtirumanur/">https://www.linkedin.com/in/ananthtirumanur/</a></li>
<li>⚡ Fun fact: Marathoner &amp; Casual Birding enthusiast</li>
</ul>
<h3>Connect with me:</h3>
<ul>
<li>Twitter: <a href="https://twitter.com/akrish82">@akrish82</a></li>
<li>LinkedIn: <a href="https://linkedin.com/in/ananthtirumanur/">https://linkedin.com/in/ananthtirumanur/</a></li>
</ul>
<h3>My Resources:</h3>
<ul>
<li>LinkedIn Newsletter: <a href="https://www.linkedin.com/newsletters/data-engineering-with-aws-7096111313352880128/">Data Engineering with AWS</a></li>
<li>Udemy Course: <a href="https://www.udemy.com/course/aws-certified-data-engineer-associate-practice-test/learn/quiz/6218524#overview">AWS Certified Data Engineer Associate Practice Test</a></li>
<li>Python Crash Course: <a href="https://akrish82.gumroad.com/l/python-crash-course">Python Crash Course on Gumroad</a></li>
</ul>
<h3>Languages and Tools:</h3>
<p>AWS, Bash, Docker, Elasticsearch, Git, Grafana, Hadoop, Hive, EMR, Glue, Athena, Lambda, Step Functions, Airflow/MWAA, DynamoDB, Kafka, Kubernetes, Linux, MariaDB, MySQL, Pandas, PostgreSQL, Python, Redis, Scala, SQLite</p>
</footer>
</body></html>
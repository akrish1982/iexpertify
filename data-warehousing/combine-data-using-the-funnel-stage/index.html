<html><head><link href="/simplecss/styles.css" rel="stylesheet"/>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3040480045347797"
     crossorigin="anonymous"></script>
     <script
    src="https://topmate-embed.s3.ap-south-1.amazonaws.com/v1/topmate-embed.js"
    user-profile="https://topmate.io/embed/profile/ananth_tirumanur?theme=D5534D"
    btn-style='{"backgroundColor":"#000","color":"#fff","border":"1px solid #000"}'
    embed-version="v1"
    button-text="Let's Connect"
    position-right="30px"
    position-bottom="30px"
    custom-padding="0px"
    custom-font-size="16px"
    custom-font-weight="500"
    custom-width="200px"
    async=""
    defer=""
  ></script>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VS67BGEQZW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VS67BGEQZW');
</script>  
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="https://www.iexpertify.com/">iExpertify</a></li>
                <li><a href="https://www.iexpertify.com/free-utilities/">Free Utilities</a></li>
            </ul>
        </nav>
    </header>






Combine data using the Funnel stage - Data Warehousing Data Warehousing



Reading Time:  6 minutes
<p>It is a processing stage that supports n inputs and 1 output.</p>
<p>Combining Source 1 and Source 1 without any key dependency</p>
 
we will cover these topics: 
<a class="lwptoc_toggle_label" data-label="show" href="index.html#">hide</a>



 <a href="index.html#Funnel_requirements">
1)
Funnel requirements
</a>
 <a href="index.html#Funnel_types">
2)
Funnel types
</a>
 <a href="index.html#Copy">
3)
Copy
</a>
 <a href="index.html#job-_funnel_copy_Generator_and_copy">
3.1)
job:- funnel, copy Generator, and copy
</a>
 <a href="index.html#Sequential_file_0">
3.1.1)
Sequential file 0
</a>
 <a href="index.html#lwptoc">
4)
â†“
</a>
 <a href="index.html#lwptoc1">
5)
â†“
</a>
 <a href="index.html#Sequential_file_1">
5.1)
Sequential file 1
</a>
 <a href="index.html#Column_Generator">
5.2)
Column Generator
</a>
 <a href="index.html#Copy1">
5.3)
Copy
</a>
 <a href="index.html#Funnel">
5.4)
Funnel
</a>
 <a href="index.html#Output">
5.4.1)
Output
</a>
 <a href="index.html#Job-_Not_Applicable">
5.5)
Job:- (Not Applicable)
</a>
 <a href="index.html#Sequential_file_11">
5.5.1)
Sequential file 1
</a>
 <a href="index.html#Sequential_file_01">
5.5.2)
Sequential file 0
</a>
 <a href="index.html#lookup">
5.6)
lookup
</a>
 <a href="index.html#Column_Generator1">
5.7)
Column Generator
</a>
 <a href="index.html#output">
5.8)
output
</a>
 <a href="index.html#Data_set_0">
5.9)
Data set 0
</a>
 <a href="index.html#Output1">
5.9.1)
Output
</a>
 <a href="index.html#Conditions">
5.10)
Conditions
</a>
 <a href="index.html#Constraints">
5.11)
Constraints
</a>
 <a href="index.html#Job-_Not_Applicable1">
5.12)
Job:- (Not Applicable)
</a>
 <a href="index.html#Sequential_file_02">
5.12.1)
Sequential file 0
</a>
 <a href="index.html#Sequential_file_12">
5.12.2)
Sequential file 1
</a>
 <a href="index.html#Sequential_file_2">
5.12.3)
Sequential file 2
</a>
 <a href="index.html#Ref2">
5.12.4)
Ref2
</a>
 <a href="index.html#Lookup">
5.13)
Lookup
</a>
 <a href="index.html#Output2">
5.13.1)
Output
</a>
 <a href="index.html#What_to_read_next">
5.14)
What to read next?
</a>

<h3>Funnel requirements</h3>
<ol><li>Structure of Source 1 and Source 2 should be the same</li><li>Column Names should be the same in Source 1 and Source 2.</li></ol>
<h3>Funnel typesÂ </h3>
<p>We have 3 Funnel types</p>
<ol><li>Continuous funnelÂ Â Random</li><li>SequenceÂ follows Linux order</li><li>Sort funnelÂ Â based on key column values</li></ol>
<h2>Â CopyÂ </h2>
<p>It is having multi-purpose</p>
<ul><li>Makes Source to Multiple copies</li><li>Change the column Names</li><li>Drop the columns</li><li>used as Stub Stage.</li></ul>
<h3>job:- funnel, copy Generator, and copy</h3>

Sequential file 0
<h1>Â â†“</h1>
<p>Load</p>
<h1>Â Â â†“</h1>
<p>E idÂ Â Â Â Â  Â Â Â Â Â Â Â E NameÂ Â Â Â Â  Add</p>
<p>11Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  AÂ Â Â Â Â Â Â Â Â Â Â Â  HYD</p>
<p>22Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  EÂ Â Â Â Â Â Â Â Â Â Â Â  SEC Â </p>
Sequential file 1
<p>E idÂ Â Â Â Â Â Â Â  E NameÂ Â Â  GenderÂ Â Â Â Â Â Â Â  SalÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Add</p>
<p>33Â Â Â Â Â Â Â Â Â Â Â Â Â  BÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  1Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  23000Â Â Â Â Â Â Â Â Â Â Â Â  HYD</p>
<p>22Â Â Â Â Â Â Â Â Â Â Â Â  CÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  0Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  22000Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Del Â </p>
<h3>Column GeneratorÂ </h3>
<p>Column to GenerateÂ Â Â Â Â Â Â  = COUNTRY</p>
<p>Column to GenerateÂ Â Â Â Â Â Â  = COMPANY</p>
<p>Output</p>
<p>Do MappingÂ Â Â  (link 13) Â </p>
<h3>CopyÂ </h3>
<p>outputDump (link)Ã  do Mapping</p>
<p>Now,OutputFunnelÂ  (link)Do MappingRemoveÂ Â  DSlink 13.COMPANY / DSlink 13.COUNTRYGo toÂ  Columnsif any column Name changes have to be mode, do it here.</p>
<h3>FunnelÂ </h3>
<p>funnel Type = Continuous funnelOutputDo Mapping</p>
OutputÂ 
<p>Data set 0</p>
<table><tbody><tr><td>E id</td><td>E Name</td><td>Add</td></tr><tr><td>33</td><td>B</td><td>HYD</td></tr><tr><td>44</td><td>C</td><td>DEL</td></tr><tr><td>11</td><td>A</td><td>HYD</td></tr><tr><td>22</td><td>E</td><td>SEC</td></tr></tbody></table>
<table><tbody><tr><td>E id</td><td>E Name</td><td>Gender</td><td>Sal</td><td>Add</td><td>Country</td><td>Company</td></tr><tr><td>33</td><td>B</td><td>1</td><td>23000</td><td>HYD</td><td>aaa</td><td>aaa</td></tr><tr><td>44</td><td>C</td><td>0</td><td>22000</td><td>DEL</td><td>bbb</td><td>Bbb</td></tr></tbody></table>
<p>Â  Data set</p>
<h3>Job:-Â  (Not Applicable)</h3>

Sequential file 1Â 
<p>Load primary.txt</p>
Sequential file 0Â 
<p>Load ref.txt</p>
<p>In bothÂ  primary.txt and ref.txt Â Â ColumnsÂ Â  State</p>
<h3>lookupÂ </h3>
<p>Ã Map StateÂ Drag and Drop Required ColumnsGo to ConstraintsSet reject Â </p>
<h3>Column GeneratorÂ </h3>
<p>Column to GenerateÂ Â Â Â Â  = STATE â€“ DESCOutputÃ Do MappingColumnsRight click on STATE â€“ DESCAlgorithm = CycleValueÂ Â  = not applicableApplyCloseÂ Compile And RUN</p>
<h3>outputÂ </h3>
<h3>Data set 0</h3>
<table><tbody><tr><td>E id</td><td>E Name</td><td>State</td><td>Status</td><td>State â€“ desc</td></tr><tr><td>11</td><td>SUMAN</td><td>AP</td><td>1001</td><td>Andhra Pradesh</td></tr><tr><td>22</td><td>MOON</td><td>TN</td><td>1000</td><td>Tamil Nadu</td></tr><tr><td>33</td><td>SUMAN</td><td>AP</td><td>1111</td><td>Andhra Pradesh</td></tr><tr><td>55</td><td>SUMAN</td><td>AP</td><td>1101</td><td>Andhra Pradesh</td></tr><tr><td>66</td><td>MOON</td><td>JK</td><td>1001</td><td>Jammu Kashmir</td></tr><tr><td>77</td><td>MOONSUN</td><td>AP</td><td>1011</td><td>Andhra Pradesh</td></tr></tbody></table>
<table><tbody><tr><td>E id</td><td>E Name</td><td>State</td><td>Status</td><td>State â€“ desc</td></tr><tr><td>44</td><td>MOONSTAR</td><td>NN</td><td>1011</td><td>Not Applicable</td></tr><tr><td>88</td><td>MOON</td><td>MP</td><td>1111</td><td>Not Applicable</td></tr></tbody></table>
<p>Â Â Data set 1</p>

OutputÂ 
<table><tbody><tr><td>E id</td><td>E Name</td><td>State</td><td>Status</td><td>State â€“ desc</td></tr><tr><td>11</td><td>SUMAN</td><td>AP</td><td>1001</td><td>Andhra Pradesh</td></tr><tr><td>22</td><td>MOON</td><td>TN</td><td>1000</td><td>Tamil Nadu</td></tr><tr><td>33</td><td>SUMAN</td><td>AP</td><td>1111</td><td>Andhra Pradesh</td></tr><tr><td>55</td><td>SUMAN</td><td>AP</td><td>1101</td><td>Andhra Pradesh</td></tr><tr><td>66</td><td>MOON</td><td>JK</td><td>1001</td><td>Jammu Kashmir</td></tr><tr><td>77</td><td>MOONSUN</td><td>AP</td><td>1011</td><td>Andhra Pradesh</td></tr><tr><td>44</td><td>MOON STAR</td><td>NN</td><td>1011</td><td>Not Applicable</td></tr><tr><td>88</td><td>MOON</td><td>MP</td><td>1111</td><td>Not Applicable</td></tr></tbody></table>
<p>Inclined to build a profession as Datastage Developer? Then here is the blog post on, exploreÂ <a href="https://tekslate.com/datastage-training" rel="noreferrer noopener" target="_blank">Datastage Training</a></p>
<h3>ConditionsÂ </h3>
<p>While using lookup, We Can Write the conditions in Constraints</p>
<p>That is Generally when we take 2 sequential files</p>
<p>1.primary and 1 reference file, we can Write Conditions for the only the primary file</p>
<h3>Constraints</h3>
<p>Link NameÂ Â Â Â Â Â Â Â Â Â Â Â Â Â  ConditionÂ Â Â Â Â Â Â Â Â Â  Condition Not MetÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Lookup failure</p>
<p>RefÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  DropÂ Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Drop</p>
<p>Right-clickÂ Input column Â Â primary</p>
<ul><li>If we need to write Conditions for reference file then, take 3 Sequential files</li><li>That is 1 primary, reference file, reference file i</li></ul>
<ol start="4"><li>job</li></ol>
<h3>Job:- (Not Applicable)</h3>

Sequential fileÂ  0Â Â Â 
<p>Â Load primary.txtÂ columnsÂ Â state</p>
Â Â Sequential file 1
<p>Load ref.txt Â Â columnsstate Â </p>
Sequential file 2Â 
<p>Load rfe2.txtÂ Â columnsÂ Â state Â </p>
Ref2Â 
<table><tbody><tr><td>Status</td><td>Status- desc</td></tr><tr><td>1001</td><td>Married</td></tr><tr><td>1000</td><td>Divorced</td></tr><tr><td>1111</td><td>Single</td></tr></tbody></table>
<h3>Â Â Lookup</h3>
<p>Â Drag State from primary to ref</p>
<p>Drag Status from primary to ref 1</p>
<p>Now, Drag and Drop required ColumnsClick on Constraints Â </p>
<table><tbody><tr><td>Link Name</td><td>condition</td><td>Condition Not met</td><td>Lookup failure</td></tr><tr><td>ref</td><td>Drop</td><td>Drop</td></tr><tr><td>2.ref1</td><td>Â </td><td>Drop</td><td>Drop</td></tr></tbody></table>
<p>Â  Right clickInput ColumnÂ refÂ ref. State â€“descÂ  = â€œAndhraÂ  Pradeshâ€</p>
<p>Now, Compile And RUNÂ Â </p>
Output
<table><tbody><tr><td>E id</td><td>E Name</td><td>State</td><td>Status</td><td>State â€“ desc</td><td>Â </td></tr><tr><td>11</td><td>SUMAN</td><td>AP</td><td>1001</td><td>Andhra Pradesh</td><td>Married</td></tr><tr><td>33</td><td>SUMAN</td><td>Ap</td><td>1111</td><td>Andhra Pradesh</td><td>Single</td></tr></tbody></table>

<br><br>
<footer>
<h3>Meet Ananth Tirumanur. Hi there ğŸ‘‹</h3>

    <h4>I work on projects in data science, big data, data engineering, data modeling, software engineering, and system design.</h4>

    <ul>
        <li>ğŸ‘¨â€ğŸ’» All of my projects are available at <a href="https://github.com/akrish1982">https://github.com/akrish1982</a></li>
        <li>ğŸ’¬ Ask me about <strong>Data engineering, SQL, Databases, Data pipelines, Data infrastructure</strong></li>
        <li>ğŸ“„ My work history: <a href="https://www.linkedin.com/in/ananthtirumanur/">https://www.linkedin.com/in/ananthtirumanur/</a></li>
        <li>âš¡ Fun fact: Marathoner & Casual Birding enthusiast</li>
    </ul>
    <iframe height='160' width='300' frameborder='0' allowtransparency='true' scrolling='no' src='https://www.strava.com/athletes/42567926/activity-summary/6bbf7aabb6546e61f1317a54d973b259158da8a8'></iframe>


    <h3>Connect with me:</h3>
    <ul>
        <li>Twitter: <a href="https://twitter.com/akrish82">@akrish82</a></li>
        <li>LinkedIn: <a href="https://linkedin.com/in/ananthtirumanur/">https://linkedin.com/in/ananthtirumanur/</a></li>
    </ul>

<h3>My Resources:</h3>
    <ul>
        <li>LinkedIn Newsletter: <a href="https://www.linkedin.com/newsletters/data-engineering-with-aws-7096111313352880128/">Data Engineering with AWS</a></li>
        <li>Udemy Course: <a href="https://www.udemy.com/course/aws-certified-data-engineer-associate-practice-test/learn/quiz/6218524#overview">AWS Certified Data Engineer Associate Practice Test</a></li>
        <li>Python Crash Course: <a href="https://akrish82.gumroad.com/l/python-crash-course">Python Crash Course on Gumroad</a></li>
    </ul>

    <h3>Languages and Tools:</h3>
    <p>AWS, Bash, Docker, Elasticsearch, Git, Grafana, Hadoop, Hive, EMR, Glue, Athena, Lambda, Step Functions, Airflow/MWAA, DynamoDB, Kafka, Kubernetes, Linux, MariaDB, MySQL, Pandas, PostgreSQL, Python, Redis, Scala, SQLite</p>
</footer>
</body>
</html>





 





 
 






